{"code":"import { __awaiter } from \"tslib\";\nimport { drawGrid } from \"./utils\";\nimport { Tile, TileType, Direction } from \"./Tile\";\n(function () {\n    if (typeof document === \"undefined\" || typeof window === \"undefined\") {\n        return;\n    }\n    document.addEventListener(\"DOMContentLoaded\", () => __awaiter(this, void 0, void 0, function* () {\n        const canvas = document.querySelector(\"#maze\");\n        const PLAYER_SIZE_FACTOR = 0.15;\n        const PLANE_SIZE = 10;\n        const CELL_SIZE = canvas.width / PLANE_SIZE;\n        const PLAYER_SIZE = CELL_SIZE * PLAYER_SIZE_FACTOR;\n        const context = canvas.getContext(\"2d\");\n        context.imageSmoothingEnabled = false;\n        const tileTypes = Object.keys(TileType).filter((type) => isNaN(Number(type)));\n        const renderPlane = (plane) => {\n            plane.forEach((tile, cell) => {\n                context.drawImage(tile.image, (cell % PLANE_SIZE) * CELL_SIZE, Math.floor(cell / PLANE_SIZE) * CELL_SIZE, CELL_SIZE, CELL_SIZE);\n            });\n        };\n        const renderPlayer = (Player) => {\n            context.fillStyle = \"red\";\n            context.fillRect(CELL_SIZE * (Player.x + 0.5) - PLAYER_SIZE / 2, CELL_SIZE * (Player.y + 0.5) - PLAYER_SIZE / 2, PLAYER_SIZE, PLAYER_SIZE);\n        };\n        const Plane = new Array(PLANE_SIZE * PLANE_SIZE).fill(undefined);\n        const Player = {\n            x: Math.floor(PLANE_SIZE / 2),\n            y: Math.floor(PLANE_SIZE / 2),\n        };\n        const updatePlayer = (direction) => {\n            let currx = Player.x;\n            let curry = Player.y;\n            const currentPlayerTile = Plane[curry * PLANE_SIZE + currx];\n            const allowedDriections = currentPlayerTile.getAllowedDirections();\n            switch (direction) {\n                case Direction.top:\n                    if (allowedDriections.indexOf(direction) != -1 && curry > 0) {\n                        curry--;\n                    }\n                    break;\n                case Direction.right:\n                    if (allowedDriections.indexOf(direction) != -1 &&\n                        currx < PLANE_SIZE - 1) {\n                        currx++;\n                    }\n                    break;\n                case Direction.bottom:\n                    if (allowedDriections.indexOf(direction) != -1 &&\n                        curry < PLANE_SIZE - 1) {\n                        curry++;\n                    }\n                    break;\n                case Direction.left:\n                    if (allowedDriections.indexOf(direction) != -1 && currx > 0) {\n                        currx--;\n                    }\n                    break;\n            }\n            Player.x = currx;\n            Player.y = curry;\n        };\n        const tiles = tileTypes.map((type) => new Tile(TileType[type], `./assets/tiles_colored/Tile${type}.png`));\n        yield drawGrid(tiles, Plane, PLANE_SIZE);\n        renderPlane(Plane);\n        renderPlayer(Player);\n        window.onkeypress = (event) => {\n            switch (event.key) {\n                case \"w\":\n                    updatePlayer(Direction.top);\n                    break;\n                case \"a\":\n                    updatePlayer(Direction.left);\n                    break;\n                case \"s\":\n                    updatePlayer(Direction.bottom);\n                    break;\n                case \"d\":\n                    updatePlayer(Direction.right);\n                    break;\n                default:\n                    break;\n            }\n            renderPlane(Plane);\n            renderPlayer(Player);\n        };\n    }));\n})();\n//# sourceMappingURL=index.js.map","references":["/Users/rafal.tomaszewski/projects/ts/maze/src/utils.ts","/Users/rafal.tomaszewski/projects/ts/maze/src/Tile.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/index.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,QAAQ,EAAc,MAAM,SAAS,CAAC;AAC/C,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAmB,MAAM,QAAQ,CAAC;AAEpE,CAAC;IACC,IAAI,OAAO,QAAQ,KAAK,WAAW,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE,CAAC;QACrE,OAAO;IACT,CAAC;IAED,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,GAAS,EAAE;QACvD,MAAM,MAAM,GAAsB,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAClE,MAAM,kBAAkB,GAAG,IAAI,CAAC;QAChC,MAAM,UAAU,GAAG,EAAE,CAAC;QACtB,MAAM,SAAS,GAAW,MAAM,CAAC,KAAK,GAAG,UAAU,CAAC;QACpD,MAAM,WAAW,GAAW,SAAS,GAAG,kBAAkB,CAAC;QAC3D,MAAM,OAAO,GAA6B,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAClE,OAAO,CAAC,qBAAqB,GAAG,KAAK,CAAC;QACtC,MAAM,SAAS,GAAa,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAChE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CACpB,CAAC;QAEF,MAAM,WAAW,GAAG,CAAC,KAAY,EAAE,EAAE;YACnC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAU,EAAE,IAAI,EAAE,EAAE;gBACjC,OAAO,CAAC,SAAS,CACf,IAAI,CAAC,KAAK,EACV,CAAC,IAAI,GAAG,UAAU,CAAC,GAAG,SAAS,EAC/B,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC,GAAG,SAAS,EACzC,SAAS,EACT,SAAS,CACV,CAAC;YACJ,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,MAAM,YAAY,GAAG,CAAC,MAAgC,EAAE,EAAE;YACxD,OAAO,CAAC,SAAS,GAAG,KAAK,CAAC;YAC1B,OAAO,CAAC,QAAQ,CACd,SAAS,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,WAAW,GAAG,CAAC,EAC9C,SAAS,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,WAAW,GAAG,CAAC,EAC9C,WAAW,EACX,WAAW,CACZ,CAAC;QACJ,CAAC,CAAC;QAEF,MAAM,KAAK,GAAU,IAAI,KAAK,CAAC,UAAU,GAAG,UAAU,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACxE,MAAM,MAAM,GAAG;YACb,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC;YAC7B,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC;SAC9B,CAAC;QAEF,MAAM,YAAY,GAAG,CAAC,SAAqB,EAAE,EAAE;YAC7C,IAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC;YACrB,IAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC;YACrB,MAAM,iBAAiB,GAAS,KAAK,CAAC,KAAK,GAAG,UAAU,GAAG,KAAK,CAAS,CAAC;YAC1E,MAAM,iBAAiB,GAAG,iBAAiB,CAAC,oBAAoB,EAAE,CAAC;YACnE,QAAQ,SAAS,EAAE,CAAC;gBAClB,KAAK,SAAS,CAAC,GAAG;oBAChB,IAAI,iBAAiB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,GAAG,CAAC,EAAE,CAAC;wBAC5D,KAAK,EAAE,CAAC;oBACV,CAAC;oBACD,MAAM;gBACR,KAAK,SAAS,CAAC,KAAK;oBAClB,IACE,iBAAiB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;wBAC1C,KAAK,GAAG,UAAU,GAAG,CAAC,EACtB,CAAC;wBACD,KAAK,EAAE,CAAC;oBACV,CAAC;oBACD,MAAM;gBACR,KAAK,SAAS,CAAC,MAAM;oBACnB,IACE,iBAAiB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;wBAC1C,KAAK,GAAG,UAAU,GAAG,CAAC,EACtB,CAAC;wBACD,KAAK,EAAE,CAAC;oBACV,CAAC;oBACD,MAAM;gBACR,KAAK,SAAS,CAAC,IAAI;oBACjB,IAAI,iBAAiB,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,GAAG,CAAC,EAAE,CAAC;wBAC5D,KAAK,EAAE,CAAC;oBACV,CAAC;oBACD,MAAM;YACV,CAAC;YAED,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC;YACjB,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC;QACnB,CAAC,CAAC;QAEF,MAAM,KAAK,GAAW,SAAS,CAAC,GAAG,CACjC,CAAC,IAAY,EAAE,EAAE,CACf,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,8BAA8B,IAAI,MAAM,CAAC,CACrE,CAAC;QAEF,MAAM,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;QAEzC,WAAW,CAAC,KAAK,CAAC,CAAC;QACnB,YAAY,CAAC,MAAM,CAAC,CAAC;QAErB,MAAM,CAAC,UAAU,GAAG,CAAC,KAAoB,EAAE,EAAE;YAC3C,QAAQ,KAAK,CAAC,GAAG,EAAE,CAAC;gBAClB,KAAK,GAAG;oBACN,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;oBAC5B,MAAM;gBACR,KAAK,GAAG;oBACN,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;oBAC7B,MAAM;gBACR,KAAK,GAAG;oBACN,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;oBAC/B,MAAM;gBACR,KAAK,GAAG;oBACN,YAAY,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;oBAC9B,MAAM;gBACR;oBACE,MAAM;YACV,CAAC;YAED,WAAW,CAAC,KAAK,CAAC,CAAC;YACnB,YAAY,CAAC,MAAM,CAAC,CAAC;QACvB,CAAC,CAAC;IACJ,CAAC,CAAA,CAAC,CAAC;AACL,CAAC,CAAC,EAAE,CAAC\"}"}
